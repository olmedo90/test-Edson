<%- include('../components/header.html') %>
<%- include('../components/navigation.html') %>
<div class="container py-4">
    <h3> Mis Comentarios</h3>
    <table class="table py-4">
        <thead class=" bg-dark text-white">
            <tr>
                <th scope="col"> Correo Electronico</th>
                <th scope="col"> Comentario</th>
                <th scope="col">Acciones</th>
            </tr>
        </thead>
        <% if (arrayComentarios.length> 0) {%>
            <%arrayComentarios.forEach(comentario=>{ %>
                <tbody>
                    <tr>
                        <th>
                            <%= comentario.email %>
                        </th>
                        <th>
                            <%= comentario.comentario %>
                        </th>
                        <th>
                           <button class=" btn btn-danger btn-sm" id="btnDelete" data-id=<%=comentario.id %> >
                                Eliminar
                           </button>
                        </th>
                    </tr>
                    <%})%>
                        <% }%>
                </tbody>
    </table>
</div>

<%- include('../components/footer.html') %>
<script>
    const btnDelete = document.querySelector('#btnDelete')
    btnDelete.addEventListener('click',async()=>{
        const id=btnDelete.dataset.id;
        console.log('click me diste');
         try {
             const data = await fetch (`/comentarios/${id}`,{
                 method:'delete'
             });
             const res = await data.json();
             if(res.estado){
                 window.location.href ='/comentarios';
             }else{
                 console.log(res);
             }
         } catch (error) {
             console.log(error);
         }
    })
</script>